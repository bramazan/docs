---
title: Migration Guides
description: Step-by-step guides for upgrading between API versions and migrating from other payment providers
icon: 'arrow-right-arrow-left'
---

# Migration Guides

Upgrade paths and migration strategies for moving to or between versions of Ödeal Payment Infrastructure.

## Version Migration

### Migrating to API v2.x

<Info>
If you're using API v1.x, we strongly recommend upgrading to v2.x for improved performance, security, and features.
</Info>

#### Breaking Changes from v1.x to v2.x

<Warning>
**API v1.x End-of-Life**: June 30, 2026
</Warning>

**Key Differences:**

| Feature | v1.x | v2.x |
|---------|------|------|
| Base URL | `/api/payment/*` | `/v1/payments/*` |
| Authentication | API Key in query | Bearer token in header |
| Response Format | `{success, data}` | Direct object `{id, status, ...}` |
| Error Format | `{error: string}` | `{error: {code, message}}` |
| Idempotency | Optional | Required for mutations |

#### Step-by-Step Migration

<Steps>
  <Step title="Update Base URL">
    Change API endpoint URLs:
    
    ```diff
    - https://api.odeal.com/api/payment/create
    + https://api.odeal.com/v1/payments
    ```
  </Step>
  
  <Step title="Update Authentication">
    Move API key from query parameter to Authorization header:
    
    ```diff
    - GET /api/payment/status?apiKey=YOUR_KEY&id=123
    + GET /v1/payments/123
    + Headers: Authorization: Bearer YOUR_API_KEY
    ```
  </Step>
  
  <Step title="Update Request Format">
    Modify request payloads:
    
    ```diff
    {
    - "merchant_id": "123",
    + "merchantId": "123",
    - "card_number": "4111111111111111",
    + "card": {
    +   "number": "4111111111111111",
    +   "holderName": "John Doe",
    +   "expiryMonth": "12",
    +   "expiryYear": "2025",
    +   "cvv": "123"
    + }
    }
    ```
  </Step>
  
  <Step title="Update Response Handling">
    Adapt to new response structure:
    
    ```diff
    - if (response.success) {
    -   const payment = response.data;
    + if (response.status === 'SUCCEEDED') {
    +   const transactionId = response.transactionId;
    }
    ```
  </Step>
  
  <Step title="Add Idempotency Keys">
    Include idempotency keys for all mutations:
    
    ```javascript
    fetch('/v1/payments', {
      method: 'POST',
      headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'X-Idempotency-Key': generateIdempotencyKey()
      }
    });
    ```
  </Step>
  
  <Step title="Update Error Handling">
    Handle structured error responses:
    
    ```diff
    - if (response.error) {
    -   console.error(response.error);
    + if (response.error) {
    +   console.error(response.error.code, response.error.message);
    }
    ```
  </Step>
  
  <Step title="Test Thoroughly">
    - Test all payment flows in sandbox
    - Verify webhook handling
    - Test error scenarios
    - Validate 3DS flow
  </Step>
  
  <Step title="Deploy to Production">
    - Update production API keys
    - Monitor error rates closely
    - Have rollback plan ready
  </Step>
</Steps>

#### Code Migration Examples

<CodeGroup>

```javascript v1.x (Old)
// V1 - Old approach
const response = await fetch(
  `https://api.odeal.com/api/payment/create?apiKey=${API_KEY}`,
  {
    method: 'POST',
    body: JSON.stringify({
      merchant_id: '123',
      amount: 100,
      card_number: '4111111111111111',
      card_holder: 'John Doe',
      expiry: '12/25',
      cvv: '123'
    })
  }
);

const result = await response.json();
if (result.success) {
  console.log('Payment ID:', result.data.id);
}
```

```javascript v2.x (New)
// V2 - New approach
const response = await fetch(
  'https://api.odeal.com/v1/payments',
  {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'Content-Type': 'application/json',
      'X-Idempotency-Key': `order-${orderId}-${Date.now()}`
    },
    body: JSON.stringify({
      merchantId: '123',
      amount: 100.00,
      currency: 'TRY',
      card: {
        number: '4111111111111111',
        holderName: 'John Doe',
        expiryMonth: '12',
        expiryYear: '2025',
        cvv: '123'
      }
    })
  }
);

const payment = await response.json();
if (payment.status === 'SUCCEEDED') {
  console.log('Payment ID:', payment.id);
}
```

</CodeGroup>

---

## Migrating from Other Payment Providers

### From Stripe

<AccordionGroup>
  <Accordion title="API Comparison">
    | Feature | Stripe | Ödeal |
    |---------|--------|-------|
    | Create Payment | `PaymentIntents.create()` | `POST /v1/payments` |
    | Capture | `PaymentIntent.capture()` | `POST /v1/payments/:id/capture` |
    | Refund | `Refunds.create()` | `POST /v1/payments/:id/refund` |
    | Customer | `Customers.create()` |  Managed via `customerId` field |
    | Webhooks | `webhook_endpoints` | `POST /v1/webhooks` |
  </Accordion>
  
  <Accordion title="Conceptual Mapping">
    **Stripe Concept → Ödeal Equivalent:**
    
    - PaymentIntent → Payment
    - PaymentMethod → cardToken (from saved card)
    - Customer → customerId (your internal ID)
    - Charge → Transaction
    - Refund → Refund
    - Webhook Event → Webhook Event
    - Idempotency Key → X-Idempotency-Key header
  </Accordion>
  
  <Accordion title="Migration Code Example">
    ```javascript
    // Stripe
    const paymentIntent = await stripe.paymentIntents.create({
      amount: 10000,
      currency: 'try',
      payment_method: pm_card_visa,
      confirm: true
    });
    
    // Ödeal
    const payment = await fetch('https://api.odeal.com/v1/payments', {
      method: 'POST',
      headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json',
        'X-Idempotency-Key': idempotencyKey
      },
      body: JSON.stringify({
        merchantId: 'your-merchant-id',
        amount: 100.00,
        currency: 'TRY',
        card: cardDetails
      })
    }).then(r => r.json());
    ```
  </Accordion>
</AccordionGroup>

---

### From PayPal / Braintree

<AccordionGroup>
  <Accordion title="Key Differences">
    **PayPal/Braintree → Ödeal:**
    
    - Client/Server tokens → API Key authentication
    - JavaScript SDK → Direct API calls or upcoming SDKs
    - Vault for cards → `saveCard` option
    - Transaction.sale() → POST /v1/payments
    - Transaction.refund() → POST /v1/payments/:id/refund
  </Accordion>
  
  <Accordion title="Migration Example">
    ```javascript
    // Braintree
    gateway.transaction.sale({
      amount: '100.00',
      paymentMethodNonce: nonceFromTheClient,
      options: {
        submitForSettlement: true
      }
    });
    
    // Ödeal
    fetch('https://api.odeal.com/v1/payments', {
      method: 'POST',
      headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        merchantId: 'merchant-id',
        amount: 100.00,
        currency: 'TRY',
        card: cardDetails
      })
    });
    ```
  </Accordion>
</AccordionGroup>

---

### From Iyzico

<AccordionGroup>
  <Accordion title="API Comparison">
    | Feature | Iyzico | Ödeal |
    |---------|--------|-------|
    | Payment | `Payment.create()` | `POST /v1/payments` |
    | 3D Secure | `ThreedsPayment.create()` | Automatic via `POST /v1/payments/:id/process` |
    | Submerchant | `SubMerchant.create()` | `POST /v1/merchants` |
    | Installment | `installment` param | `installments` param |
  </Accordion>
  
  <Accordion title="Migration Steps">
    1. **Authentication**: Replace Iyzico API/secret keys with Ödeal API key
    2. **Endpoint URLs**: Update to Ödeal base URL
    3. **Request Format**: Adapt to Ödeal's JSON structure
    4. **3DS Handling**: Use Ödeal's unified 3DS flow
    5. **Webhooks**: Re-register webhook endpoints
    6. **Testing**: Validate with Ödeal test cards
  </Accordion>
</AccordionGroup>

---

## Database Migration

If you're storing payment data, you may need to migrate stored information:

### Payment Status Mapping

```sql
-- Map old status values to new
UPDATE payments
SET status = CASE
  WHEN old_status = 'completed' THEN 'SUCCEEDED'
  WHEN old_status = 'pending' THEN 'PROCESSING'
  WHEN old_status = 'failed' THEN 'FAILED'
  WHEN old_status = 'refunded' THEN 'REFUNDED'
  WHEN old_status = 'cancelled' THEN 'VOIDED'
  ELSE 'UNKNOWN'
END;
```

### Card Token Migration

<Warning>
**Never migrate raw card numbers!** Always use tokenization.
</Warning>

```javascript
// Securely migrate saved cards
async function migrateCards() {
  const oldCards = await db.cards.find({ provider: 'old-provider' });
  
  for (const card of oldCards) {
    // Use old provider's API to get card details
    const cardDetails = await oldProvider.getCard(card.token);
    
    // Create verification payment with Ödeal to tokenize
    const payment = await odeal.createPayment({
      amount: 0.50,
      saveCard: true,
      customerId: card.customerId,
      card: cardDetails
    });
    
    // Store new Ödeal token
    await db.cards.update(card.id, {
      provider: 'odeal',
      token: payment.cardToken
    });
    
    // Delete old token
    await oldProvider.deleteCard(card.token);
  }
}
```

---

## Webhook Migration

Update webhook endpoints and event handling:

### Event Name Mapping

| Old Provider | Ödeal Event |
|--------------|-------------|
| `payment.succeeded` | `payment.succeeded` |
| `payment.failed` | `payment.failed` |
| `charge.refunded` | `refund.completed` |
| `charge.captured` | `payment.captured` |

### Webhook Signature Verification

```javascript
// Old provider
const valid = stripe.webhooks.constructEvent(
  body,
  signature,
  webhookSecret
);

// Ödeal
const crypto = require('crypto');

function verifyWebhook(body, signature, secret) {
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(body)
    .digest('hex');
    
  return signature === expectedSignature;
}
```

---

## Testing Your Migration

<Steps>
  <Step title="Create Test Account">
    Set up Ödeal test environment credentials
  </Step>
  
  <Step title="Implement Side-by-Side">
    Run both old and new integrations in parallel (test mode)
  </Step>
  
  <Step title="Validate Results">
    Compare outcomes between old and new providers
  </Step>
  
  <Step title="Load Testing">
    Test with realistic transaction volumes
  </Step>
  
  <Step title="Gradual Rollout">
    Start with 10% of traffic, gradually increase
  </Step>
  
  <Step title="Monitor Metrics">
    Track success rates, errors, latency
  </Step>
  
  <Step title="Complete Migration">
    Once confident, switch 100% to Ödeal
  </Step>
</Steps>

---

## Migration Checklist

<Check>Update API endpoints and authentication</Check>
<Check>Migrate request/response handling</Check>
<Check>Add idempotency keys</Check>
<Check>Update error handling</Check>
<Check>Migrate webhook configuration</Check>
<Check>Test all payment flows</Check>
<Check>Test 3D Secure</Check>
<Check>Validate refund/void operations</Check>
<Check>Update monitoring and alerts</Check>
<Check>Train team on new API</Check>
<Check>Update documentation</Check>
<Check>Plan rollback strategy</Check>
<Check>Schedule maintenance window</Check>
<Check>Execute migration</Check>
<Check>Monitor post-migration</Check>

---

## Need Help?

<CardGroup cols={2}>
  <Card title="Migration Support" icon="headset" href="/resources/support">
    Contact our team for migration assistance
  </Card>
  
  <Card title="API Reference" icon="code" href="/api-reference">
    Complete API documentation
  </Card>
  
  <Card title="Changelog" icon="clock" href="/resources/changelog">
    View all API changes
  </Card>
  
  <Card title="Community" icon="discord" href="https://discord.gg/odeal">
    Ask the community for help
  </Card>
</CardGroup>

Migration assistance is available for Premium and Enterprise customers. Contact [migration@odeal.com](mailto:migration@odeal.com) to schedule a consultation.
