---
title: Mutabakat API
description: Banka mutabakat işlemleri
---

# Mutabakat API (Reconciliation)

Banka ile işlem mutabakatı sağlama ve raporlama.

## Mutabakat Raporu Oluşturma

### `POST /v1/reconciliation/generate`

Belirli bir tarih için mutabakat raporu oluşturur.

```bash
POST /v1/reconciliation/generate
Authorization: Bearer API_ANAHTARINIZ
Content-Type: application/json
```

#### İstek Gövdesi

```json
{
  "reconciliationDate": "2025-12-19",
  "bankCode": "GARANTI",
  "merchantId": "mrc_abc123"
}
```

#### Yanıt

```json
{
  "reconciliationId": "rec_xyz789",
  "date": "2025-12-19",
  "bankCode": "GARANTI",
  "status": "Completed",
  "summary": {
    "totalTransactions": 1250,
    "matchedTransactions": 1245,
    "unmatchedTransactions": 5,
    "totalAmount": 125000.00,
    "matchedAmount": 124500.00,
    "unmatchedAmount": 500.00
  },
  "createdAt": "2025-12-20T00:30:00Z"
}
```

---

## Mutabakat Detayı

### `GET /v1/reconciliation/{id}`

Mutabakat raporunun detaylarını getirir.

```bash
GET /v1/reconciliation/rec_xyz789
Authorization: Bearer API_ANAHTARINIZ
```

#### Yanıt

```json
{
  "reconciliationId": "rec_xyz789",
  "date": "2025-12-19",
  "bankCode": "GARANTI",
  "matched": [
    {
      "transactionId": "trx_123",
      "rrn": "000123456789",
      "amount": 100.00,
      "bankAmount": 100.00,
      "status": "Matched"
    }
  ],
  "unmatched": [
    {
      "transactionId": "trx_456",
      "rrn": "000987654321",
      "amount": 50.00,
      "bankAmount": null,
      "reason": "NotFoundInBankReport"
    }
  ],
  "summary": {
    "totalTransactions": 1250,
    "matchedCount": 1245,
    "unmatchedCount": 5,
    "matchPercentage": 99.6
  }
}
```

---

## Eşleşmeyen İşlemler

### `GET /v1/reconciliation/{id}/unmatched`

Eşleşmeyen işlemleri listeler.

```bash
GET /v1/reconciliation/rec_xyz789/unmatched
Authorization: Bearer API_ANAHTARINIZ
```

#### Yanıt

```json
{
  "unmatchedTransactions": [
    {
      "transactionId": "trx_456",
      "date": "2025-12-19",
      "amount": 50.00,
      "rrn": "000987654321",
      "authCode": "456789",
      "reason": "NotFoundInBankReport",
      "suggestion": "Ertesi gün bankadan kontrol edin"
    },
    {
      "transactionId": "trx_789",
      "date": "2025-12-19",
      "amount": 75.00,
      "rrn": "000111222333",
      "authCode": "789012",
      "reason": "AmountMismatch",
      "ourAmount": 75.00,
      "bankAmount": 74.50,
      "difference": 0.50
    }
  ],
  "total": 5
}
```

---

## Mutabakat Export

### `GET /v1/reconciliation/{id}/export`

Mutabakat raporunu export eder.

```bash
GET /v1/reconciliation/rec_xyz789/export?format=excel
Authorization: Bearer API_ANAHTARINIZ
```

#### Query Parametreleri

| Parametre | Değerler | Açıklama |
|-----------|----------|----------|
| `format` | `excel`, `csv`, `pdf` | Export formatı |

---

## Eşleşmeme Nedenleri

| Neden | Açıklama | Aksiyon |
|-------|----------|---------|
| `NotFoundInBankReport` | Banka raporunda yok | Ertesi gün kontrol et |
| `AmountMismatch` | Tutar uyuşmazlığı | Manuel kontrol gerekli |
| `DateMismatch` | Tarih uyuşmazlığı | Valör farkı olabilir |
| `DuplicateTransaction` | Duplike işlem | Tekil işlemi bul |

---

## Otomatik Mutabakat

Mutabakat otomatik olarak her gün çalışır:
- **Çalışma Zamanı**: Her gün 01:00 (UTC+3)
- **Kapsam**: Önceki günün tüm işlemleri
- **Bildirim**: Eşleşmeyen işlem varsa e-posta gönderilir

---

## İlgili Kaynaklar

- [İşlemler API](/api-reference/transactions)
- [Ödeme Hesaplama API](/api-reference/settlements)
