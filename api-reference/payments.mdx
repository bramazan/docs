---
title: Payments API
description: Sanal POS ile kart Ã¶demelerini kabul edin - DetaylÄ± entegrasyon rehberi
icon: 'credit-card'
---

# Payments API

Sanal POS (Virtual POS) altyapÄ±mÄ±z Ã¼zerinden kredi ve banka kartÄ± Ã¶demelerini kabul edin. Bu, Ã¶deme iÅŸlemlerinin temel API'sidir.

<Note>
**Sanal POS Nedir?** Fiziksel POS cihazÄ± olmadan, web siteniz veya uygulamanÄ±z Ã¼zerinden kredi kartÄ± Ã¶demesi almanÄ±zÄ± saÄŸlayan dijital bir sistemdir. Ã–deal, birden fazla banka ile entegre sanal POS hizmeti sunar.
</Note>

## NasÄ±l Ã‡alÄ±ÅŸÄ±r?

<Steps>
  <Step title="1. Ã–deme Ä°steÄŸi OluÅŸturun">
    MÃ¼ÅŸteriniz sipariÅŸ verdiÄŸinde, sunucunuzdan bir Ã¶deme kaydÄ± oluÅŸturun
  </Step>
  
  <Step title="2. Kart Bilgilerini Ä°ÅŸleyin">
    Kart numarasÄ±, CVV ve son kullanma tarihini API'ye gÃ¶nderin
  </Step>
  
  <Step title="3. Banka ile Ä°letiÅŸim">
    Ã–deal, otomatik olarak en uygun bankayÄ± seÃ§er ve iÅŸlemi yÃ¶nlendirir
  </Step>
  
  <Step title="4. 3D Secure (Opsiyonel)">
    GÃ¼venlik iÃ§in mÃ¼ÅŸteriyi banka doÄŸrulama sayfasÄ±na yÃ¶nlendirin
  </Step>
  
  <Step title="5. Sonucu AlÄ±n">
    Ã–deme baÅŸarÄ±lÄ±/baÅŸarÄ±sÄ±z sonucunu webhook ile anlÄ±k Ã¶ÄŸrenin
  </Step>
</Steps>

---

## Payment Objesi

Her Ã¶deme iÅŸlemi aÅŸaÄŸÄ±daki bilgileri iÃ§erir:

```json
{
  "id": "pay_2SNXnJ8udQoI9yKzME",
  "merchantId": "mer_7R8aB3GhN1",
  "amount": 250.00,
  "currency": "TRY",
  "status": "SUCCEEDED",
  "orderId": "order-12345",
  "card": {
    "brand": "VISA",
    "last4": "4242",
    "expiryMonth": "12",
    "expiryYear": "2025"
  },
  "threeDSecure": {
    "enabled": true,
    "status": "AUTHENTICATED"
  },
  "bankResponseCode": "00",
  "bankResponseMessage": "Ä°ÅŸleminiz baÅŸarÄ±yla tamamlandÄ±",
  "transactionId": "tx_9K3mL2pQwE",
  "createdAt": "2025-12-19T21:30:00Z"
}
```

### Ã–nemli Alanlar

| Alan | AÃ§Ä±klama |
|------|----------|
| `id` | Ã–deme ID'si - Her iÅŸlem iÃ§in benzersiz |
| `status` | Ã–deme durumu (PENDING, SUCCEEDED, FAILED, vb.) |
| `bankResponseCode` | Banka yanÄ±t kodu (00 = baÅŸarÄ±lÄ±) |
| `transactionId` | Ä°zlenebilirlik iÃ§in iÅŸlem numarasÄ± |
| `card.brand` | Kart markasÄ± (VISA, MASTERCARD, AMEX) |
| `threeDSecure.status` | 3D Secure doÄŸrulama durumu |

---

## Ã–deme OluÅŸturma

**Endpoint:** `POST /v1/payments`

### Temel Ã–rnek (Non-3D)

3D Secure olmadan basit Ã¶deme kabul etme:

<CodeGroup>

```bash cURL
curl -X POST https://api.odeal.com/v1/payments \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -H "X-Idempotency-Key: order-12345-1703001600" \
  -d '{
    "merchantId": "mer_abc123",
    "amount": 250.00,
    "currency": "TRY",
    "orderId": "order-12345",
    "card": {
      "number": "4111111111111111",
      "holderName": "AHMET YILMAZ",
      "expiryMonth": "12",
      "expiryYear": "2025",
      "cvv": "123"
    },
    "threeDSecure": false
  }'
```

```javascript JavaScript / Node.js
const response = await fetch('https://api.odeal.com/v1/payments', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.ODEAL_API_KEY}`,
    'Content-Type': 'application/json',
    'X-Idempotency-Key': `order-12345-${Date.now()}`
  },
  body: JSON.stringify({
    merchantId: 'mer_abc123',
    amount: 250.00,
    currency: 'TRY',
    orderId: 'order-12345',
    card: {
      number: '4111111111111111',
      holderName: 'AHMET YILMAZ',
      expiryMonth: '12',
      expiryYear: '2025',
      cvv: '123'
    },
    threeDSecure: false
  })
});

const payment = await response.json();

if (payment.status === 'SUCCEEDED') {
  console.log('âœ… Ã–deme baÅŸarÄ±lÄ±!');
  console.log('Ä°ÅŸlem No:', payment.transactionId);
} else {
  console.error('âŒ Ã–deme baÅŸarÄ±sÄ±z:', payment.bankResponseMessage);
}
```

```python Python
import requests
import os

response = requests.post(
    'https://api.odeal.com/v1/payments',
    headers={
        'Authorization': f'Bearer {os.getenv("ODEAL_API_KEY")}',
        'Content-Type': 'application/json',
        'X-Idempotency-Key': f'order-12345-{int(time.time())}'
    },
    json={
        'merchantId': 'mer_abc123',
        'amount': 250.00,
        'currency': 'TRY',
        'orderId': 'order-12345',
        'card': {
            'number': '4111111111111111',
            'holderName': 'AHMET YILMAZ',
            'expiryMonth': '12',
            'expiryYear': '2025',
            'cvv': '123'
        },
        'threeDSecure': False
    }
)

payment = response.json()

if payment['status'] == 'SUCCEEDED':
    print(f"âœ… Ã–deme baÅŸarÄ±lÄ±! Ä°ÅŸlem No: {payment['transactionId']}")
else:
    print(f"âŒ Ã–deme baÅŸarÄ±sÄ±z: {payment['bankResponseMessage']}")
```

```php PHP
<?php
$ch = curl_init('https://api.odeal.com/v1/payments');

curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer ' . getenv('ODEAL_API_KEY'),
    'Content-Type: application/json',
    'X-Idempotency-Key: order-12345-' . time()
]);

curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode([
    'merchantId' => 'mer_abc123',
    'amount' => 250.00,
    'currency' => 'TRY',
    'orderId' => 'order-12345',
    'card' => [
        'number' => '4111111111111111',
        'holderName' => 'AHMET YILMAZ',
        'expiryMonth' => '12',
        'expiryYear' => '2025',
        'cvv' => '123'
    ],
    'threeDSecure' => false
]));

curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($ch);
$payment = json_decode($response);

if ($payment->status === 'SUCCEEDED') {
    echo "âœ… Ã–deme baÅŸarÄ±lÄ±! Ä°ÅŸlem No: " . $payment->transactionId;
} else {
    echo "âŒ Ã–deme baÅŸarÄ±sÄ±z: " . $payment->bankResponseMessage;
}

curl_close($ch);
?>
```

</CodeGroup>

### Parametreler

<ParamField body="merchantId" type="string" required>
  **Merchant ID'niz** - Onboarding sÄ±rasÄ±nda size verilen benzersiz kimlik
  
  Ã–rnek: `mer_abc123`
</ParamField>

<ParamField body="amount" type="decimal" required>
  **Ã–deme tutarÄ±** - OndalÄ±klÄ± format kullanÄ±n
  
  - Minimum: `1.00 TRY`
  - Maksimum: `100,000.00 TRY` (daha yÃ¼ksek limitler iÃ§in destek ekibiyle gÃ¶rÃ¼ÅŸÃ¼n)
  
  Ã–rnek: `250.00` (250 TL iÃ§in)
</ParamField>

<ParamField body="currency" type="string" default="TRY">
  **Para birimi** - ISO 4217 kod
  
  Desteklenen: `TRY`, `USD`, `EUR`
</ParamField>

<ParamField body="orderId" type="string">
  **SipariÅŸ ID'niz** - Mutlaka kullanÄ±n! Raporlamada iÅŸinizi kolaylaÅŸtÄ±rÄ±r
  
  Max 100 karakter
</ParamField>

<ParamField body="card" type="object" required>
  **Kart bilgileri** - Hassas veri, asla veritabanÄ±nÄ±zda saklamayÄ±n!
  
  - `number` (string, required) - 16 haneli kart numarasÄ±
  - `holderName` (string, required) - Kart sahibinin adÄ± (BÃœYÃœK HARF)
  - `expiryMonth` (string, required) - Son kullanma ayÄ± (01-12)
  - `expiryYear` (string, required) - Son kullanma yÄ±lÄ± (YYYY)
  - `cvv` (string, required) - GÃ¼venlik kodu (3-4 hane)
</ParamField>

<ParamField body="threeDSecure" type="boolean" default={false}>
  ** 3D Secure kullan** - `true` yapÄ±n, gÃ¼venlik iÃ§in Ã¶nerilir!
  
  - `false`: DoÄŸrudan Ã¶deme (daha hÄ±zlÄ±, daha riskli)
  - `true`: Banka doÄŸrulamasÄ± (daha gÃ¼venli, biraz daha yavaÅŸ)
</ParamField>

<ParamField body="installments" type="integer" default={1}>
  **Taksit sayÄ±sÄ±** - 1-12 arasÄ±
  
  - `1`: Tek Ã§ekim
  - `2-12`: Taksitli Ã¶deme
</ParamField>

<ParamField body="metadata" type="object">
  **Ã–zel verileriniz** - Ä°stediÄŸiniz key-value Ã§iftleri
  
  Max 20 anahtar, her deÄŸer max 500 karakter
  
  Ã–rnek:
  ```json
  {
    "customer_name": "Ahmet YÄ±lmaz",
    "invoice_no": "INV-2024-001"
  }
  ```
</ParamField>

### BaÅŸarÄ±lÄ± YanÄ±t (200 OK)

```json
{
  "id": "pay_2SNXnJ8udQoI9yKzME",
  "merchantId": "mer_abc123",
  "amount": 250.00,
  "currency": "TRY",
  "status": "SUCCEEDED",
  "orderId": "order-12345",
  "card": {
    "brand": "VISA",
    "last4": "1111",
    "expiryMonth": "12",
    "expiryYear": "2025"
  },
  "bankResponseCode": "00",
  "bankResponseMessage": "Ä°ÅŸleminiz baÅŸarÄ±yla tamamlandÄ±",
  "transactionId": "tx_9K3mL2pQwE",
  "createdAt": "2025-12-19T21:30:00Z"
}
```

### Hata YanÄ±tÄ± (400/402)

```json
{
  "error": {
    "code": "INSUFFICIENT_FUNDS", 
    "message": "Yetersiz bakiye",
    "detail": "KartÄ±nÄ±zda yeterli bakiye bulunmamaktadÄ±r"
  },
  "requestId": "req_xyz789"
}
```

---

## 3D Secure ile Ã–deme

3D Secure, kartÄ±n gerÃ§ek sahibi tarafÄ±ndan kullanÄ±ldÄ±ÄŸÄ±ndan emin olmak iÃ§in banka doÄŸrulamasÄ± ekler. **GÃ¼venlik iÃ§in ÅŸiddetle Ã¶nerilir!**

### AdÄ±m AdÄ±m 3DS AkÄ±ÅŸÄ±

<Steps>
  <Step title="Ã–deme BaÅŸlatÄ±n (threeDSecure: true)">
    API Ã§aÄŸrÄ±sÄ±nda `threeDSecure: true` olarak set edin
  </Step>
  
  <Step title="REQUIRES_3DS Durumunu Kontrol Edin">
    API `status: "REQUIRES_3DS"` ve `threeDSecureUrl` dÃ¶ner
  </Step>
  
  <Step title="MÃ¼ÅŸteriyi YÃ¶nlendirin">
    MÃ¼ÅŸteriyi `threeDSecureUrl` adresine yÃ¶nlendirin (redirect veya iframe)
  </Step>
  
  <Step title="MÃ¼ÅŸteri DoÄŸrulama Yapar">
    Banka, SMS OTP veya mobil uygulama ile doÄŸrulama ister
  </Step>
  
  <Step title="Callback AlÄ±n">
    DoÄŸrulama sonrasÄ± mÃ¼ÅŸteri `returnUrl`'inize yÃ¶nlendirilir
  </Step>
  
  <Step title="Sonucu SorgulayÄ±n">
    `GET /v1/payments/{id}` ile sonucu kontrol edin
  </Step>
</Steps>

### 3D Secure Ã–rnek Kod

```javascript
// 1. 3DS ile Ã¶deme baÅŸlat
const response = await fetch('https://api.odeal.com/v1/payments', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${API_KEY}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    merchantId: 'mer_abc123',
    amount: 500.00,
    currency: 'TRY',
    card: cardDetails,
    threeDSecure: true,
    returnUrl: 'https://yoursite.com/payment/callback'
  })
});

const payment = await response.json();

// 2. 3DS gerekiyorsa yÃ¶nlendir
if (payment.status === 'REQUIRES_3DS') {
  window.location.href = payment.threeDSecureUrl;
}

// 3. Callback sayfanÄ±zda sonucu kontrol edin
// GET /v1/payments/{paymentId}
const result = await fetch(
  `https://api.odeal.com/v1/payments/${paymentId}`,
  {
    headers: { 'Authorization': `Bearer ${API_KEY}` }
  }
);

const finalPayment = await result.json();

if (finalPayment.status === 'SUCCEEDED') {
  showSuccessPage();
} else {
  showFailurePage(finalPayment.bankResponseMessage);
}
```

---

## Taksitli Ã–deme

MÃ¼ÅŸterilerinize taksit seÃ§eneÄŸi sunun:

```javascript
const payment = await createPayment({
  merchantId: 'mer_abc123',
  amount: 1200.00,
  currency: 'TRY',
  installments: 6, // 6 taksit
  card: cardDetails
});

// YanÄ±t:
// AylÄ±k Ã¶deme: 200 TRY x 6 ay
```

<Note>
**Taksit UygunluÄŸu:** Her kart ve banka taksit desteklemez. API, kartÄ±n taksit yapÄ±p yapamayacaÄŸÄ±nÄ± otomatik kontrol eder.
</Note>

---

## Ã–deme Sorgulama

**Endpoint:** `GET /v1/payments/{id}`

```bash
curl https://api.odeal.com/v1/payments/pay_2SNXnJ8udQoI9yKzME \
  -H "Authorization: Bearer sk_live_..."
```

### KullanÄ±m SenaryolarÄ±

1. **Webhook gelmedi mi?** Ã–deme durumunu sorgulayÄ±n
2. **MÃ¼ÅŸteri sayfayÄ± kapattÄ±:** Son durumu Ã¶ÄŸrenin  
3. **Raporlama:** GeÃ§miÅŸ Ã¶demeleri kontrol edin

---

## Ã–deme Ä°ptali (Void)

AynÄ± gÃ¼n iÃ§inde yapÄ±lan bir Ã¶demeyi iptal edin (bankaya gitmeden):

**Endpoint:** `POST /v1/payments/{id}/void`

```bash
curl -X POST https://api.odeal.com/v1/payments/pay_abc/void \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{"reason": "MÃ¼ÅŸteri iade talebi"}'
```

<Warning>
**Dikkat:** Void sadece iÅŸlem gÃ¼nÃ¼ yapÄ±labilir. Ertesi gÃ¼n iÃ§in `refund` kullanmalÄ±sÄ±nÄ±z.
</Warning>

---

## Ä°ade (Refund)

TamamlanmÄ±ÅŸ Ã¶demeden para iadesi yapÄ±n:

**Endpoint:** `POST /v1/payments/{id}/refund`

### Tam Ä°ade

```json
{
  "amount": 250.00, // Toplam tutar
  "reason": "ÃœrÃ¼n iade edildi"
}
```

### KÄ±smi Ä°ade

```json
{
  "amount": 100.00, // KÄ±smi tutar (250 TL'den 100 TL)
  "reason": "Bir Ã¼rÃ¼n iade, diÄŸerleri kaldÄ±"
}
```

---

## Durum Kodlar (Status)

| Durum | AÃ§Ä±klama | Ne YapmalÄ±? |
|-------|----------|-------------|
| `PENDING` | Ã–deme oluÅŸturuldu, henÃ¼z iÅŸlenmedi | Bekleyin veya process edin |
| `PROCESSING` | Banka ile iletiÅŸimde | Bekleyin (genelde 2-5 sn) |
| `REQUIRES_3DS` | 3D Secure doÄŸrulama gerekiyor | MÃ¼ÅŸteriyi yÃ¶nlendirin |
| `SUCCEEDED` | âœ… Ã–deme baÅŸarÄ±lÄ± | SipariÅŸi tamamlayÄ±n |
| `FAILED` | âŒ Ã–deme baÅŸarÄ±sÄ±z | HatayÄ± gÃ¶sterin, yeni kart isteyin |
| `VOIDED` | Ä°ptal edildi | Ä°ÅŸlem geri alÄ±ndÄ± |
| `REFUNDED` | Ä°ade yapÄ±ldÄ± | Para mÃ¼ÅŸteriye iade edildi |

---

## Hata KodlarÄ±

| Kod | TÃ¼rkÃ§e AÃ§Ä±klama | Ã‡Ã¶zÃ¼m |
|-----|-----------------|-------|
| `INSUFFICIENT_FUNDS` | Yetersiz bakiye | FarklÄ± kart isteyin |
| `INVALID_CARD` | GeÃ§ersiz kart | Kart bilgilerini kontrol ettirin |
| `EXPIRED_CARD` | KartÄ±n sÃ¼resi dolmuÅŸ | GÃ¼ncel kart isteyin |
| `INVALID_CVV` | YanlÄ±ÅŸ CVV | CVV'yi doÄŸru girmesini isteyin |
| `3DS_FAILED` | 3D Secure baÅŸarÄ±sÄ±z | MÃ¼ÅŸteri yanlÄ±ÅŸ OTP girdi, tekrar denesin |
| `CARD_BLOCKED` | Kart bloke | Banka ile gÃ¶rÃ¼ÅŸmesini sÃ¶yleyin |
| `LIMIT_EXCEEDED` | Limit aÅŸÄ±ldÄ± | Tutar azaltÄ±n veya farklÄ± kart |

---

## Test KartlarÄ±

**Test ortamÄ± iÃ§in:**

| Kart NumarasÄ± | Marka | Senaryo |
|---------------|-------|---------|
| `4111111111111111` | Visa | âœ… BaÅŸarÄ±lÄ± |
| `5400619360964581` | Mastercard | âœ… BaÅŸarÄ±lÄ± |
| `4000000000000002` | Visa | âŒ Reddedilir (CARD_DECLINED) |
| `4000000000000069` | Visa | âŒ SÃ¼resi dolmuÅŸ (EXPIRED_CARD) |
| `4000000000000127` | Visa | âŒ Yetersiz bakiye |
| `4000000000000010` | Visa | ğŸ” 3DS gerektirir |

**Test iÃ§in:** CVV: `123`, Son kullanma: `12/2025`

---

## En Ä°yi Uygulamalar

<AccordionGroup>
  <Accordion title="1. Her Zaman Idempotency Key KullanÄ±n">
    AynÄ± isteÄŸi 2 kez gÃ¶ndersen bile 2 Ã¶deme oluÅŸmasÄ±nÄ± engeller:
    
    ```javascript
    headers: {
      'X-Idempotency-Key': `order-${orderId}-${timestamp}`
    }
    ```
  </Accordion>
  
  <Accordion title="2. Kart Bilgilerini Asla SaklamayÄ±n">
    **PCI DSS uyumluluÄŸu iÃ§in:** Kart numarasÄ±nÄ± database'e yazmayÄ±n. API'ye direkt gÃ¶nderip sonucu iÅŸleyin.
  </Accordion>
  
  <Accordion title="3. Webhook KullanÄ±n">
    Ã–deme durumlarÄ±nÄ± gerÃ§ek zamanlÄ± Ã¶ÄŸrenmek iÃ§in webhook setup yapÄ±n. Manuel sorgulama yerine otomatik bildirim alÄ±n.
  </Accordion>
  
  <Accordion title="4. 3D Secure KullanÄ±n">
    GÃ¼venlik iÃ§in her zaman `threeDSecure: true` kullanÄ±n. Fraud riskini %90 azaltÄ±r.
  </Accordion>
  
  <Accordion title="5. HatalarÄ± Loglay">
    Her baÅŸarÄ±sÄ±z Ã¶demeyi loglayÄ±n. `bankResponseCode` ve `bankResponseMessage` kaydedin.
    
    ```javascript
    if (payment.status === 'FAILED') {
      logger.error('Payment failed', {
        orderId,
        errorCode: payment.error.code,
        bankResponse: payment.bankResponseMessage
      });
    }
    ```
  </Accordion>
</AccordionGroup>

---

## SÄ±k Sorulan Sorular

<AccordionGroup>
  <Accordion title="Hangi bankalarla Ã§alÄ±ÅŸÄ±yorsunuz?">
    Ã–deal, 7 bÃ¼yÃ¼k TÃ¼rk bankasÄ± ile entegredir:
    - Ä°ÅŸ BankasÄ±
    - Garanti BBVA
    - YapÄ± Kredi
    - Akbank
    - Denizbank
    - TEB
    - Ziraat BankasÄ±
    
    API otomatik olarak en uygun bankayÄ± seÃ§er (smart routing).
  </Accordion>
  
  <Accordion title="Ä°ÅŸlem Ã¼creti ne kadar?">
    Ãœcretlendirme, iÅŸlem hacminize gÃ¶re deÄŸiÅŸir. [sales@odeal.com](mailto:sales@odeal.com) adresinden teklif alÄ±n.
  </Accordion>
  
  <Accordion title="Para ne zaman hesabÄ±ma geÃ§er?">
    - **TÃ¼rk bankalarÄ±:** T+1 veya T+2 (1-2 iÅŸ gÃ¼nÃ¼)
    - **YurtdÄ±ÅŸÄ± kartlar:** T+3 - T+5
  </Accordion>
  
  <Accordion title="Test environment nasÄ±l kullanÄ±rÄ±m?">
    API key'inizi `sk_test_...` ile baÅŸlayan test key ile deÄŸiÅŸtirin. Base URL aynÄ± kalÄ±r.
  </Accordion>
</AccordionGroup>

---

## Ä°lgili Sayfalar

<CardGroup cols={2}>
  <Card title="3D Secure DetaylarÄ±" icon="shield" href="/features/3ds-integration">
    3D Secure entegrasyonu detaylÄ± anlatÄ±m
  </Card>
  
  <Card title="Webhooks" icon="webhook" href="/api-reference/webhooks">
    GerÃ§ek zamanlÄ± Ã¶deme bildirimleri
  </Card>
  
  <Card title="Hata Ã‡Ã¶zÃ¼mleri" icon="triangle-exclamation" href="/troubleshooting/payment-failures">
    Ã–deme hatalarÄ± ve Ã§Ã¶zÃ¼mleri
  </Card>
  
  <Card title="HÄ±zlÄ± BaÅŸlangÄ±Ã§" icon="rocket" href="/quickstart">
    Ä°lk Ã¶demenizi 5 dakikada alÄ±n
  </Card>
</CardGroup>
