---
title: Ödeme Hesaplama API
description: Merchant settlement (ödeme hesaplama) işlemleri
---

# Ödeme Hesaplama API (Settlements)

Üye işyerlerine yapılacak ödemeleri hesaplama, sorgulama ve raporlama.

## Ödeme Hesaplama

### `POST /v1/settlements/calculate`

Belirli bir tarih aralığı için ödeme hesaplaması yapar.

```bash
POST /v1/settlements/calculate
Authorization: Bearer API_ANAHTARINIZ
Content-Type: application/json
```

#### İstek Gövdesi

```json
{
  "startDate": "2025-12-01",
  "endDate": "2025-12-31",
  "merchantId": "mrc_abc123"
}
```

#### Parametreler

| Parametre | Tip | Zorunlu | Açıklama |
|-----------|-----|---------|----------|
| `startDate` | date | Evet | Başlangıç tarihi |
| `endDate` | date | Evet | Bitiş tarihi |
| `merchantId` | string | Hayır | Belirli bir merchant için hesaplama |

#### Yanıt (200 OK)

```json
{
  "settlements": [
    {
      "id": "set_xyz789",
      "merchantId": "mrc_abc123",
      "merchantName": "Acme Teknoloji A.Ş.",
      "periodStart": "2025-12-01",
      "periodEnd": "2025-12-31",
      "totalTransactions": 1250,
      "grossAmount": 125000.00,
      "refundAmount": -5000.00,
      "commissionAmount": -12000.00,
      "netAmount": 108000.00,
      "currency": "TRY",
      "status": "Pending",
      "createdAt": "2025-12-31T23:00:00Z"
    }
  ]
}
```

---

## Ödeme Detayı

### `GET /v1/settlements/{id}`

Belirli bir ödeme hesaplamasının detaylarını getirir.

```bash
GET /v1/settlements/set_xyz789
Authorization: Bearer API_ANAHTARINIZ
```

#### Yanıt

```json
{
  "id": "set_xyz789",
  "merchantId": "mrc_abc123",
  "merchantName": "Acme Teknoloji A.Ş.",
  "periodStart": "2025-12-01",
  "periodEnd": "2025-12-31",
  "items": [
    {
      "transactionId": "trx_123",
      "transactionDate": "2025-12-15",
      "amount": 100.00,
      "commission": -9.60,
      "refundAmount": 0.00,
      "netAmount": 90.40
    }
  ],
  "summary": {
    "totalTransactions": 1250,
    "grossAmount": 125000.00,
    "totalCommission": -12000.00,
    "totalRefunds": -5000.00,
    "netAmount": 108000.00
  },
  "currency": "TRY",
  "status": "Calculated"
}
```

---

## Merchant Ödemeleri

### `GET /v1/settlements/merchant/{merchantId}`

Bir merchant'ın tüm ödemelerini listeler.

```bash
GET /v1/settlements/merchant/mrc_abc123?startDate=2025-01-01&endDate=2025-12-31
Authorization: Bearer API_ANAHTARINIZ
```

#### Query Parametreleri

| Parametre | Tip | Zorunlu | Açıklama |
|-----------|-----|---------|----------|
| `startDate` | date | Hayır | Filtreleme başlangıç tarihi |
| `endDate` | date | Hayır | Filtreleme bitiş tarihi |

#### Yanıt

```json
{
  "merchantId": "mrc_abc123",
  "settlements": [
    {
      "id": "set_jan",
      "period": "2025-01",
      "netAmount": 45000.00,
      "status": "Paid",
      "paidAt": "2025-02-05"
    },
    {
      "id": "set_feb",
      "period": "2025-02",
      "netAmount": 52000.00,
      "status": "Paid",
      "paidAt": "2025-03-05"
    }
  ],
  "totalSettlements": 12,
  "totalPaidAmount": 580000.00
}
```

---

## Export

### `GET /v1/settlements/{id}/export`

Ödeme hesaplamasını JSON veya CSV formatında export eder.

```bash
GET /v1/settlements/set_xyz789/export?format=csv
Authorization: Bearer API_ANAHTARINIZ
```

#### Query Parametreleri

| Parametre | Değerler | Açıklama |
|-----------|----------|----------|
| `format` | `json`, `csv` | Export formatı |

#### Yanıt (CSV)

```csv
Transaction ID,Date,Amount,Commission,Refund,Net Amount
trx_123,2025-12-15,100.00,-9.60,0.00,90.40
trx_124,2025-12-16,200.00,-19.20,0.00,180.80
```

---

## Statüler

| Statü | Açıklama |
|--------|----------|
| `Calculated` | Hesaplandı |
| `Pending` | Ödeme bekliyor |
| `Paid` | Ödendi |
| `Failed` | Ödeme başarısız |
| `Cancelled` | İptal edildi |

---

## Ödeme Periyotları

### Otomatik Hesaplama

Ödemeler otomatik olarak hesaplanır:
- **Günlük**: Her gün 00:00
- **Haftalık**: Her Pazartesi
- **Aylık**: Her ayın 1'i

### Manuel Hesaplama

İhtiyaç halinde manuel hesaplama yapabilirsiniz:

```bash
POST /v1/settlements/calculate
```

---

## Komisyon Hesaplama

Komisyon hesaplama formülü:

```
Net Tutar = Brüt Tutar - Komisyon - İadeler
```

### Komisyon Oranları

Merchant bazlı komisyon oranları:
- **Standart**: %2.5
- **Kurumsal**: %1.9
- **Startup**: %3.5

<Note>
Komisyon oranları merchant anlaşmasına göre değişir.
</Note>

---

## İlgili Kaynaklar

- [İşlemler API](/api-reference/transactions)
- [Merchant API](/api-reference/merchants)
